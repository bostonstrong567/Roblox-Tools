local Module = {}

local TweenService = game:GetService("TweenService")

function Module.UltimateTween(object_to_tween, destination, options)
    local update_rate = options.updateRate or 1/30
    local player = game.Players.LocalPlayer
    local humanoid = player.Character:WaitForChild("Humanoid")
    local walk_speed = humanoid.WalkSpeed

    local function applyTween(target, end_cframe, tween_info)
        local tween_goal = {}
        tween_goal.CFrame = end_cframe
        local tween = TweenService:Create(target, tween_info, tween_goal)
        tween:Play()
    end

    local function updateTween()
        local time, easing_style, easing_direction = 5, Enum.EasingStyle.Linear, Enum.EasingDirection.In
        local tween_speed = options.speed or "Default"

        if tween_speed == "Slow" then
            time = 10
        elseif tween_speed == "Fast" then
            time = 1
        elseif tween_speed == "AntiCheat" then
            local distance_to_destination = (destination.Position - object_to_tween.Position).Magnitude
            time = distance_to_destination / walk_speed
        end

        local tween_info = TweenInfo.new(time, easing_style, easing_direction)

        if object_to_tween:IsA("Model") then
            if object_to_tween:FindFirstChild("HumanoidRootPart") then
                applyTween(object_to_tween.HumanoidRootPart, destination, tween_info)
            else
                for _, part in pairs(object_to_tween:GetChildren()) do
                    if part:IsA("BasePart") then
                        applyTween(part, destination, tween_info)
                    end
                end
            end
        else
            applyTween(object_to_tween, destination, tween_info)
        end
    end

    -- Run the update function at the specified rate
    while wait(update_rate) do
        updateTween()
    end
end

return Module
